CREATE EXTENSION IF NOT EXISTS "uuid-ossp" SCHEMA "itinerary";

CREATE TABLE TRIP (
    ID UUID DEFAULT "itinerary".uuid_generate_v4(),
    TRIP_ID BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    TRIP_NAME VARCHAR(100) NOT NULL,
    DESTINATION VARCHAR(100) NOT NULL,
    START_DATE TIMESTAMP,
    END_DATE TIMESTAMP,
    TRIP_LENGTH INTEGER,
    DESCRIPTION VARCHAR(100),
    IS_PUBLIC BOOLEAN NOT NULL,
    IS_ACTIVE BOOLEAN NOT NULL,
    CREATED_ON TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    CREATED_BY VARCHAR(100) NOT NULL,
    UPDATED_ON TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    UPDATED_BY VARCHAR(100) NOT NULL,
    CONSTRAINT TRIP_PKEY PRIMARY KEY (ID)
);

CREATE TABLE PLACE (
    ID UUID DEFAULT "itinerary".uuid_generate_v4(),
    PLACE_ID BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    DAY_NO INTEGER,
    DESCRIPTION VARCHAR(100),
    IS_ACTIVE BOOLEAN NOT NULL,
    CREATED_ON TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    CREATED_BY VARCHAR(100) NOT NULL,
    UPDATED_ON TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    UPDATED_BY VARCHAR(100) NOT NULL,
    CONSTRAINT PLACE_PKEY PRIMARY KEY (ID)
);

CREATE TABLE PLACE_META (
    ID UUID DEFAULT "itinerary".uuid_generate_v4(),
    PLACE_META_ID BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    PLACE_NAME VARCHAR(100) NOT NULL,
    PLACE_ID UUID NOT NULL,
    JURISDICTION_ID UUID NOT NULL,
    IS_ACTIVE BOOLEAN NOT NULL,
    CREATED_ON TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    CREATED_BY VARCHAR(100) NOT NULL,
    UPDATED_ON TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    UPDATED_BY VARCHAR(100) NOT NULL,
    CONSTRAINT PLACE_META_PKEY PRIMARY KEY (ID),
    CONSTRAINT PLACE_ID_FKEY FOREIGN KEY (PLACE_ID) REFERENCES itinerary.PLACE(ID),
    CONSTRAINT JURISDICTION_ID_FKEY FOREIGN KEY (JURISDICTION_ID) REFERENCES resourcehub.JURISDICTION(ID)
);

CREATE TABLE ACTIVITY (
    ID UUID DEFAULT "itinerary".uuid_generate_v4(),
    ACTIVITY_ID BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    ACTIVITY_TYPE_ID UUID NOT NULL,
    SERVICE_PROVIDER_NAME VARCHAR(100),
    SORT_ORDER VARCHAR(50),
    START_TIME TIMESTAMP,
    END_TIME TIMESTAMP,
    DESCRIPTION VARCHAR(100),
    IS_ACTIVE BOOLEAN NOT NULL,
    CREATED_ON TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    CREATED_BY VARCHAR(100) NOT NULL,
    UPDATED_ON TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    UPDATED_BY VARCHAR(100) NOT NULL,
    CONSTRAINT ACTIVITY_PKEY PRIMARY KEY (ID),
    CONSTRAINT ACTIVITY_TYPE_ID_FKEY FOREIGN KEY (ACTIVITY_TYPE_ID) REFERENCES resourcehub.REF_TERM(ID)
);

CREATE TABLE TRANSPORT (
    ID UUID DEFAULT "itinerary".uuid_generate_v4(),
    TRANSPORT_ID BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    START_LOC_ID UUID NOT NULL,
    END_LOC_ID UUID NOT NULL,
    TRANSPORT_TYPE_ID UUID NOT NULL,
    DISTANCE INTEGER,
    MODE_OF_TRANSPORT VARCHAR(50),
    IS_ACTIVE BOOLEAN NOT NULL,
    CREATED_ON TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    CREATED_BY VARCHAR(100) NOT NULL,
    UPDATED_ON TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    UPDATED_BY VARCHAR(100) NOT NULL,
    CONSTRAINT TRANSPORT_PKEY PRIMARY KEY (ID),
    CONSTRAINT START_LOC_ID_FKEY FOREIGN KEY (START_LOC_ID) REFERENCES itinerary.PLACE(ID),
    CONSTRAINT END_LOC_ID_FKEY FOREIGN KEY (END_LOC_ID) REFERENCES itinerary.PLACE(ID),
    CONSTRAINT TRANSPORT_TYPE_ID_FKEY FOREIGN KEY (TRANSPORT_TYPE_ID) REFERENCES resourcehub.REF_TERM(ID),
    CONSTRAINT MODE_OF_TRANSPORT_FKEY FOREIGN KEY (MODE_OF_TRANSPORT) REFERENCES resourcehub.REF_TERM(ID)
);